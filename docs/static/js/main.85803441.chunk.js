(this["webpackJsonpjs-app"]=this["webpackJsonpjs-app"]||[]).push([[0],{26:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),i=n(15),a=n.n(i),s=(n(26),n(19)),o=n(1),f=n(21),u=n(9),h=n.n(u),d=n(16),_=n.n(d);var b,l,j,m=n(17),p=n(18),v=function(){function e(t){Object(m.a)(this,e);var n=t.instance,r=t.wasm_func,c=t.width,i=t.height;this.instance=n,this.width=c,this.height=i,this.frame_buffer_ptr=n.malloc(c*i*4*Uint8Array.BYTES_PER_ELEMENT),this.result_buffer_ptr=n.malloc(128*Uint16Array.BYTES_PER_ELEMENT),this.bytes_memory=new Uint8Array(this.instance.memory.buffer),this.wasm_func=n[r],this.process=this.process.bind(this)}return Object(p.a)(e,[{key:"process",value:function(e){this.bytes_memory.set(e,this.frame_buffer_ptr,this.frame_buffer_ptr/Uint8Array.BYTES_PER_ELEMENT),this.wasm_func(this.frame_buffer_ptr,this.width,this.height,this.result_buffer_ptr);var t=new Uint16Array(this.instance.memory.buffer,this.result_buffer_ptr),n=t[0],r=[];if(n>0)for(var c=0,i=1;c<n;c++){for(var a="",s="",o=t[i],f=o+t[i+1],u=i+2;u<i+f+2;u++)u<i+o+2?a+=String.fromCharCode(t[u]):s+=String.fromCharCode(t[u]);i+=f+2,r.push({type:a,data:s,points:{x0:t[i],y0:t[i+1],x1:t[i+2],y1:t[i+3]}}),i+=4}return r}}]),e}(),g=n(2),x={wasi_snapshot_preview1:{fd_seek:function(){},fd_close:function(){},fd_write:function(){},fd_read:function(){},environ_sizes_get:function(){},environ_get:function(){},proc_exit:function(){},clock_time_get:function(){}},env:{log_char_arr:function(e,t){}}},y=function(e){var t=Object(r.useRef)(null),n=Object(r.useRef)(null),c=Object(r.useState)([]),i=Object(f.a)(c,2),a=i[0],s=i[1],o=Object(r.useCallback)((function(){var e=t.current.video,r=n.current;l=e;var c=function t(){if(requestAnimationFrame(t),!e.paused&&!e.end){var n=function(e,t,n){var r=e.videoWidth*n,c=e.videoHeight*n;t.width=r,t.height=c;var i=t.getContext("2d");i.drawImage(e,0,0,r,c);var a=i.getImageData(0,0,r,c);return a.context=i,a}(e,r,1),c=j.process(n.data);if(c.length>0){for(var i=0;i<c.length;i++){var a=c[i].points,o=a.x0,f=a.y0,u=a.x1,h=a.y1,d=r.getContext("2d");d.lineWidth=5,d.strokeStyle="#FF0000",d.beginPath(),d.moveTo(o,f),d.lineTo(o,h),d.lineTo(u,h),d.lineTo(u,f),d.lineTo(o,f),d.stroke()}s(c)}}};e.addEventListener("play",(function(){fetch("wasm/zbarapp.wasm").then((function(e){return e.arrayBuffer()})).then((function(e){return WebAssembly.instantiate(e,x)})).then((function(e){b=e.instance.exports,j=new v({instance:b,wasm_func:"func_zbar",width:400,height:400}),c()}))}),!1)}),[t,n]);return Object(r.useEffect)((function(){o&&o()}),[o]),Object(r.useEffect)((function(){return function(){l&&(l.srcObject.getTracks().forEach((function(e){return e.stop()})),l.srcObject=null);j&&b&&(b.free(j.frame_buffer_ptr),b.free(j.result_buffer_ptr))}}),[]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsx)(_.a,{audio:!1,width:1,height:1,ref:t,videoConstraints:{width:400,height:400,facingMode:"environment"}}),Object(g.jsxs)("div",{className:"container ".concat(h.a.scanner_container),children:[Object(g.jsx)("div",{className:"row justify-content-md-center",children:Object(g.jsx)("div",{className:"col-6 ".concat(h.a.code),children:a&&a.map((function(e,t){return Object(g.jsx)("label",{children:"Barcode: ".concat(e.type," - ").concat(e.data," ")},t)}))})}),Object(g.jsx)("div",{className:"row",children:Object(g.jsx)("div",{className:"col-12 ".concat(h.a.scanner),children:Object(g.jsx)("canvas",{ref:n})})})]})]})};var O=function(){return Object(g.jsx)("div",{children:Object(g.jsx)(s.a,{children:Object(g.jsx)(o.a,{exact:!0,path:"/",component:y})})})},w=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,34)).then((function(t){var n=t.getCLS,r=t.getFID,c=t.getFCP,i=t.getLCP,a=t.getTTFB;n(e),r(e),c(e),i(e),a(e)}))};a.a.render(Object(g.jsx)(c.a.StrictMode,{children:Object(g.jsx)(O,{})}),document.getElementById("root")),w()},9:function(e,t,n){e.exports={scanner_container:"Zbar_scanner_container__Fc3zg",scanner:"Zbar_scanner__2oDxN",code:"Zbar_code__1sDyJ"}}},[[33,1,2]]]);
//# sourceMappingURL=main.85803441.chunk.js.map